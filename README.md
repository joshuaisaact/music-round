# Music Round

A multiplayer song guessing game where players compete to identify songs from 30-second Spotify previews.

## Features

- Real-time multiplayer gameplay with lobby system
- Server-controlled round phases with automatic advancement
- Spotify playlist integration
- Score tracking and leaderboards
- Session-based reconnection support

## Tech Stack

- TanStack Start (React framework)
- Convex (backend & real-time database)
- Spotify Web API
- Tailwind CSS

## Getting Started

### Prerequisites

- Node.js 18+ or Bun
- A Spotify Developer account

### 1. Install Dependencies

```bash
bun install
```

### 2. Set Up Convex

Initialize Convex (creates deployment and sets up environment):

```bash
npx convex dev
```

This will create a `.env.local` file with `CONVEX_DEPLOYMENT` and `VITE_CONVEX_URL`.

### 3. Set Up Spotify Integration

1. Go to [Spotify Developer Dashboard](https://developer.spotify.com/dashboard)
2. Create a new app
3. Note your **Client ID** and **Client Secret**
4. Set redirect URI to `http://localhost:3000` (required but not used)

Add Spotify credentials to Convex (server-side):

```bash
npx convex env set SPOTIFY_CLIENT_ID your_client_id_here
npx convex env set SPOTIFY_CLIENT_SECRET your_client_secret_here
```

### 4. Run the Application

Start both the dev server and Convex:

```bash
# Terminal 1: Start Convex
npx convex dev

# Terminal 2: Start app
bun run dev
```

The app will be available at `http://localhost:3000`.

## Environment Variables

### Local `.env.local` (auto-generated by Convex)

```bash
CONVEX_DEPLOYMENT=your-deployment-name
VITE_CONVEX_URL=https://your-deployment.convex.cloud
```

### Convex Environment Variables (server-side)

Set these using `npx convex env set`:

```bash
SPOTIFY_CLIENT_ID=your_spotify_client_id
SPOTIFY_CLIENT_SECRET=your_spotify_client_secret
```

**Note:** Spotify credentials must be set in Convex, not in `.env.local`, as they're used server-side.

## Building For Production

```bash
bun run build
```

## Testing

```bash
bun run test
```

## How to Play

1. **Create a Game**: Click "Create Game" to generate a unique game code
2. **Join Lobby**: Share the game code with friends who can join the lobby
3. **Start Game**: Host starts the game when all players are ready
4. **Listen & Guess**: Each round plays a 30-second preview - guess the artist and song title
5. **Scoring**:
   - Both correct: 100 points
   - Artist only: 50 points
   - Title only: 40 points
6. **Win**: Player with the most points after all rounds wins!
